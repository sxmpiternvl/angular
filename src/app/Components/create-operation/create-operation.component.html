<div>
  <form (ngSubmit)="onSubmit()" #submitForm=ngForm>
    <h1 class="text-2xl pb-1"> Создание записи</h1>
    <div>
      <p class="p-0.5">Дата</p>
      <div class="bg-slate-50 rounded-2xl font-mono ">
        <input type="date" [(ngModel)]="date" name="date" appDateController
               [class.invalid-input]="dateModel.invalid" required
               #dateModel="ngModel">
      </div>
      <select [(ngModel)]="operationType" name="operationType" required
              class="bg-slate-50 rounded-2xl text-center py-2  my-2 w-full border appearance-none" >
        <option value="outgoing">Расход</option>
        <option value="income">Приход</option>
      </select>
      @if (operationType == 'outgoing'){
      <div>
        <p>Кому:</p>
        <select [(ngModel)]="receiverUsername" name="receiverUsername" required
                class="bg-slate-50 rounded-2xl px-4 py-2 font-mono my-2 w-full focus:outline-none border appearance-none">
          <ng-container>
            @for (user of userList;track user){
            <option class="bg-slate-50" [value]="user.username">{{ user.username }}</option>
            }
            <option class="bg-slate-50 text-center" value="N/A">N/A</option>
          </ng-container>
        </select>
      </div>
      }
      <div>
        <p>Сумма:</p>
        <input type="text" [(ngModel)]="amount" name="amount" required
               [class.invalid-input]="operationType == 'outgoing' && amountExceedsBalance()"
               (ngModelChange)="operationType == 'outgoing' ? amountExceedsBalance() : null"
               appValidateKey>
      </div>
      <div>
        <p>Комментарий</p>
        <textarea [(ngModel)]="comment" name="comment"
                  class="border focus:outline-none resize-none h-[120px] w-full align-text-top rounded-2xl bg-slate-50 p-3"
                  minlength="10" maxlength="255" appDoubleSpace>
      </textarea>
        <p class="text-gray-400 pt-2" [class.text-red-500]="comment.length!=0 && (comment.length < 10 || comment.length > 255)">
          Символов: {{ comment.length }}/10-255
        </p>
      </div>
    </div>
    <div class="grid grid-cols-2 pt-4">
      <button (click)="closeModal()" class="custom-btn-neutral-filled mx-4 bg-black ">
        <fa-icon [icon]="faXmark"></fa-icon>
        <span class="pl-1">Отменить</span>
      </button>
      <button (click)="console.log(this.amount)" type="submit" [disabled]="!submitForm.valid"
              class="custom-btn-primary mx-2">
        <fa-icon [icon]="faSave"></fa-icon>
        <span class="pl-1">Создать запись</span>
      </button>
    </div>
  </form>
</div>
