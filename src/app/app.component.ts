import { Component, } from '@angular/core';
import { RouterOutlet } from '@angular/router';
import { RouterLink } from "@angular/router";
import { AuthService } from "./auth-service";
import { CommonModule } from "@angular/common";
import { RouterLinkActive } from "@angular/router";
import { faUsers } from "@fortawesome/free-solid-svg-icons";
import { faSignature } from "@fortawesome/free-solid-svg-icons";
import { faPiggyBank } from "@fortawesome/free-solid-svg-icons";
import { FaIconComponent } from "@fortawesome/angular-fontawesome";

@Component({
  selector: 'app-root',
  standalone: true,
  imports: [RouterOutlet, RouterLink, CommonModule, RouterLinkActive, FaIconComponent],
  template: `
    <div class="flex h-screen">
      <div class="w-[16%] bg-white">
        <nav class="p-10 text-sm">
          <svg width="186" height="50" viewBox="0 0 186 50" fill="none" xmlns="http://www.w3.org/2000/svg"
               class="mb-10">
            <path
              d="M5.54863 9.96941C5.44605 9.86683 5.35209 9.7589 5.26676 9.64652C-2.38446 19.4549 -1.69927 33.6561 7.32233 42.6777C17.0854 52.4408 32.9146 52.4408 42.6777 42.6777C52.4408 32.9146 52.4408 17.0854 42.6777 7.32233C33.6561 -1.69928 19.4549 -2.38446 9.64649 5.26678C9.75888 5.35211 9.86681 5.44607 9.96939 5.54865C10.1707 5.74995 10.3388 5.97187 10.4737 6.20762C19.7894 -1.01203 33.2413 -0.345739 41.7935 8.20648C51.0683 17.4813 51.0683 32.5187 41.7935 41.7935C32.5187 51.0683 17.4813 51.0683 8.20648 41.7935C-0.345733 33.2413 -1.01202 19.7894 6.20761 10.4737C5.97186 10.3388 5.74993 10.1707 5.54863 9.96941Z"
              fill="black"/>
            <path
              d="M6.87485 6.87488C6.38655 7.36318 6.38655 8.15488 6.87485 8.64318C7.36316 9.13148 8.15486 9.13148 8.64316 8.64318C9.13146 8.15488 9.13146 7.36318 8.64316 6.87488C8.15486 6.38657 7.36316 6.38657 6.87485 6.87488Z"
              fill="#403AFF"/>
            <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M31.0848 16.2356C29.3294 14.9551 27.1668 14.1994 24.8277 14.1994C18.9578 14.1994 14.1994 18.9579 14.1994 24.8277C14.1994 30.6975 18.9578 35.4559 24.8277 35.4559C30.6975 35.4559 35.4559 30.6975 35.4559 24.8277V16.3876C35.4559 15.1791 34.4762 14.1994 33.2677 14.1994C32.1103 14.1994 31.1628 15.098 31.0848 16.2356ZM18.5758 24.8277C18.5758 28.2805 21.3748 31.0796 24.8277 31.0796C28.2805 31.0796 31.0796 28.2805 31.0796 24.8277C31.0796 21.3748 28.2805 18.5758 24.8277 18.5758C21.3748 18.5758 18.5758 21.3748 18.5758 24.8277Z"
                  fill="black"/>
            <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M9.37031 40.6297C0.73825 31.9977 0.73825 18.0023 9.37031 9.37028C18.0024 0.738221 31.9977 0.73822 40.6298 9.37028C49.2618 18.0023 49.2618 31.9977 40.6298 40.6297C31.9977 49.2618 18.0024 49.2618 9.37031 40.6297ZM40.1877 40.1876C31.7998 48.5756 18.2003 48.5756 9.81239 40.1876C1.42448 31.7997 1.42448 18.2003 9.81239 9.81236C18.2003 1.42445 31.7998 1.42445 40.1877 9.81236C48.5756 18.2003 48.5756 31.7997 40.1877 40.1876Z"
                  fill="black"/>
            <path
              d="M66.752 21L65.232 17.064H60.48L58.944 21H58L62.496 9.544H63.328L67.712 21H66.752ZM63.408 12.104C63.376 11.9973 63.328 11.8533 63.264 11.672C63.2 11.4907 63.136 11.2987 63.072 11.096C63.008 10.8933 62.944 10.712 62.88 10.552C62.8267 10.7333 62.768 10.92 62.704 11.112C62.6507 11.304 62.592 11.4853 62.528 11.656C62.4747 11.8267 62.4213 11.9813 62.368 12.12L60.8 16.232H64.944L63.408 12.104ZM74.4864 18.744C74.4864 19.256 74.3584 19.6933 74.1024 20.056C73.8464 20.4187 73.473 20.696 72.9824 20.888C72.4917 21.0693 71.8944 21.16 71.1904 21.16C70.6037 21.16 70.081 21.1067 69.6224 21C69.1637 20.8933 68.7744 20.7653 68.4544 20.616V19.736C68.8384 19.928 69.2704 20.088 69.7504 20.216C70.2304 20.3333 70.7157 20.392 71.2064 20.392C72.0597 20.392 72.673 20.2533 73.0464 19.976C73.4197 19.688 73.6064 19.2987 73.6064 18.808C73.6064 18.488 73.5157 18.2267 73.3344 18.024C73.1637 17.8107 72.9024 17.624 72.5504 17.464C72.209 17.2933 71.7824 17.1227 71.2704 16.952C70.7477 16.7707 70.2837 16.5893 69.8784 16.408C69.473 16.216 69.1584 15.976 68.9344 15.688C68.7104 15.4 68.5984 15.0053 68.5984 14.504C68.5984 13.8213 68.8757 13.288 69.4304 12.904C69.985 12.52 70.7264 12.328 71.6544 12.328C72.1664 12.328 72.641 12.376 73.0784 12.472C73.5264 12.568 73.9317 12.696 74.2944 12.856L73.9744 13.608C73.761 13.512 73.521 13.4267 73.2544 13.352C72.9877 13.2667 72.7157 13.2027 72.4384 13.16C72.161 13.1173 71.8837 13.096 71.6064 13.096C70.9344 13.096 70.4117 13.2133 70.0384 13.448C69.665 13.6827 69.4784 14.024 69.4784 14.472C69.4784 14.8133 69.5637 15.0853 69.7344 15.288C69.9157 15.48 70.177 15.6453 70.5184 15.784C70.8704 15.9227 71.2917 16.0827 71.7824 16.264C72.2837 16.4347 72.737 16.616 73.1424 16.808C73.5584 17 73.8837 17.2453 74.1184 17.544C74.3637 17.8427 74.4864 18.2427 74.4864 18.744ZM79.0268 20.392C79.2614 20.392 79.4854 20.376 79.6988 20.344C79.9121 20.3013 80.0988 20.2533 80.2588 20.2V20.936C80.0988 21 79.8961 21.0533 79.6508 21.096C79.4161 21.1387 79.1654 21.16 78.8988 21.16C78.4294 21.16 78.0294 21.0747 77.6988 20.904C77.3681 20.7227 77.1121 20.4453 76.9308 20.072C76.7601 19.6987 76.6748 19.2187 76.6748 18.632V13.224H75.4268V12.712L76.6748 12.424L77.0108 10.456H77.5868V12.488H80.2108V13.224H77.5868V18.6C77.5868 19.1867 77.7041 19.6347 77.9388 19.944C78.1734 20.2427 78.5361 20.392 79.0268 20.392ZM85.5523 12.344C85.7656 12.344 85.9683 12.36 86.1603 12.392C86.3629 12.4133 86.5443 12.4453 86.7043 12.488L86.5763 13.32C86.4056 13.2773 86.2349 13.2453 86.0643 13.224C85.8936 13.192 85.7069 13.176 85.5043 13.176C85.1203 13.176 84.7736 13.2507 84.4643 13.4C84.1549 13.5493 83.8883 13.7627 83.6643 14.04C83.4403 14.3173 83.2696 14.648 83.1523 15.032C83.0349 15.416 82.9763 15.848 82.9763 16.328V21H82.0643V12.488H82.8323L82.9283 14.088H82.9763C83.1149 13.7573 83.3016 13.464 83.5363 13.208C83.7816 12.9413 84.0749 12.7333 84.4163 12.584C84.7576 12.424 85.1363 12.344 85.5523 12.344ZM95.1686 16.744C95.1686 17.4053 95.0833 18.008 94.9126 18.552C94.7526 19.0853 94.5073 19.5493 94.1766 19.944C93.8566 20.328 93.4566 20.6267 92.9766 20.84C92.4966 21.0533 91.9473 21.16 91.3286 21.16C90.742 21.16 90.214 21.0587 89.7446 20.856C89.286 20.6427 88.8913 20.344 88.5606 19.96C88.23 19.5653 87.9793 19.096 87.8086 18.552C87.638 18.008 87.5526 17.4053 87.5526 16.744C87.5526 15.816 87.702 15.0267 88.0006 14.376C88.31 13.7147 88.7526 13.208 89.3286 12.856C89.9153 12.504 90.6086 12.328 91.4086 12.328C92.2193 12.328 92.902 12.5147 93.4566 12.888C94.022 13.2507 94.4486 13.7627 94.7366 14.424C95.0246 15.0853 95.1686 15.8587 95.1686 16.744ZM88.4966 16.744C88.4966 17.4693 88.598 18.1093 88.8006 18.664C89.0033 19.208 89.318 19.6293 89.7446 19.928C90.1713 20.2267 90.7046 20.376 91.3446 20.376C92.006 20.376 92.55 20.2267 92.9766 19.928C93.4033 19.6187 93.718 19.192 93.9206 18.648C94.1233 18.0933 94.2246 17.4587 94.2246 16.744C94.2246 16.0293 94.1286 15.4 93.9366 14.856C93.7446 14.312 93.4406 13.8853 93.0246 13.576C92.6086 13.2667 92.0646 13.112 91.3926 13.112C90.422 13.112 89.6966 13.432 89.2166 14.072C88.7366 14.712 88.4966 15.6027 88.4966 16.744ZM97.6781 21V9.576H98.6061V20.168H103.95V21H97.6781ZM114.22 16.968C114.22 17.8427 114.05 18.5947 113.708 19.224C113.367 19.8427 112.876 20.3227 112.236 20.664C111.596 20.9947 110.812 21.16 109.884 21.16C108.519 21.16 107.468 20.792 106.732 20.056C106.007 19.3093 105.644 18.2693 105.644 16.936V9.576H106.556V16.936C106.556 18.0453 106.844 18.8933 107.42 19.48C107.996 20.056 108.834 20.344 109.932 20.344C110.658 20.344 111.271 20.216 111.772 19.96C112.274 19.6933 112.652 19.3147 112.908 18.824C113.175 18.3227 113.308 17.7253 113.308 17.032V9.576H114.22V16.968ZM125.736 21H124.76L118.136 11.016H118.088C118.088 11.2293 118.093 11.448 118.104 11.672C118.114 11.8853 118.12 12.1093 118.12 12.344C118.13 12.5787 118.136 12.8187 118.136 13.064C118.146 13.2987 118.152 13.5387 118.152 13.784V21H117.288V9.576H118.28L124.872 19.528H124.92C124.92 19.368 124.914 19.1813 124.904 18.968C124.893 18.744 124.882 18.5093 124.872 18.264C124.872 18.0187 124.866 17.7733 124.856 17.528C124.856 17.2827 124.856 17.048 124.856 16.824V9.576H125.736V21Z"
              fill="black"/>
            <path
              d="M60.212 42H59.4V32.004H64.888V32.732H60.212V36.848H64.622V37.576H60.212V42ZM67.0844 34.552V42H66.3004V34.552H67.0844ZM66.6924 31.794C66.8697 31.794 67.005 31.85 67.0984 31.962C67.1917 32.0647 67.2384 32.2093 67.2384 32.396C67.2384 32.592 67.1917 32.746 67.0984 32.858C67.005 32.9607 66.8697 33.012 66.6924 33.012C66.5244 33.012 66.3937 32.9607 66.3004 32.858C66.207 32.746 66.1604 32.592 66.1604 32.396C66.1604 32.2093 66.207 32.0647 66.3004 31.962C66.3937 31.85 66.5244 31.794 66.6924 31.794ZM72.8863 34.412C73.7356 34.412 74.3843 34.6313 74.8323 35.07C75.2803 35.5087 75.5043 36.1993 75.5043 37.142V42H74.7203V37.184C74.7203 36.4653 74.5569 35.938 74.2303 35.602C73.9036 35.266 73.4229 35.098 72.7883 35.098C71.9763 35.098 71.3649 35.336 70.9543 35.812C70.5436 36.288 70.3383 36.9973 70.3383 37.94V42H69.5543V34.552H70.1843L70.3103 35.84H70.3523C70.4923 35.5693 70.6789 35.3267 70.9123 35.112C71.1456 34.8973 71.4256 34.7293 71.7523 34.608C72.0883 34.4773 72.4663 34.412 72.8863 34.412ZM80.5124 34.426C81.3524 34.426 81.9778 34.6313 82.3884 35.042C82.7991 35.4527 83.0044 36.106 83.0044 37.002V42H82.4024L82.2624 40.74H82.2204C82.0431 41.02 81.8378 41.2673 81.6044 41.482C81.3804 41.6873 81.1051 41.8507 80.7784 41.972C80.4611 42.084 80.0691 42.14 79.6024 42.14C79.1358 42.14 78.7298 42.0607 78.3844 41.902C78.0391 41.734 77.7731 41.496 77.5864 41.188C77.3998 40.88 77.3064 40.502 77.3064 40.054C77.3064 39.3167 77.6098 38.7567 78.2164 38.374C78.8231 37.982 79.7051 37.758 80.8624 37.702L82.2204 37.646V37.114C82.2204 36.3767 82.0711 35.8587 81.7724 35.56C81.4831 35.252 81.0491 35.098 80.4704 35.098C80.0878 35.098 79.7191 35.1493 79.3644 35.252C79.0191 35.3453 78.6691 35.4807 78.3144 35.658L78.0624 35.028C78.4078 34.8507 78.7904 34.706 79.2104 34.594C79.6304 34.482 80.0644 34.426 80.5124 34.426ZM80.9464 38.29C80.0038 38.3367 79.2991 38.5047 78.8324 38.794C78.3658 39.074 78.1324 39.4987 78.1324 40.068C78.1324 40.5253 78.2771 40.8753 78.5664 41.118C78.8558 41.3513 79.2478 41.468 79.7424 41.468C80.5358 41.468 81.1424 41.2487 81.5624 40.81C81.9918 40.3713 82.2111 39.7553 82.2204 38.962V38.234L80.9464 38.29ZM88.7183 34.412C89.5676 34.412 90.2163 34.6313 90.6643 35.07C91.1123 35.5087 91.3363 36.1993 91.3363 37.142V42H90.5523V37.184C90.5523 36.4653 90.389 35.938 90.0623 35.602C89.7356 35.266 89.255 35.098 88.6203 35.098C87.8083 35.098 87.197 35.336 86.7863 35.812C86.3756 36.288 86.1703 36.9973 86.1703 37.94V42H85.3863V34.552H86.0163L86.1423 35.84H86.1843C86.3243 35.5693 86.511 35.3267 86.7443 35.112C86.9776 34.8973 87.2576 34.7293 87.5843 34.608C87.9203 34.4773 88.2983 34.412 88.7183 34.412ZM96.6945 42.14C95.9665 42.14 95.3458 41.9907 94.8325 41.692C94.3285 41.384 93.9411 40.9453 93.6705 40.376C93.4091 39.8067 93.2785 39.1207 93.2785 38.318C93.2785 37.478 93.4278 36.7687 93.7265 36.19C94.0345 35.6113 94.4545 35.1727 94.9865 34.874C95.5185 34.566 96.1438 34.412 96.8625 34.412C97.2171 34.412 97.5485 34.4493 97.8565 34.524C98.1738 34.5893 98.4538 34.678 98.6965 34.79L98.4865 35.462C98.2345 35.3593 97.9638 35.28 97.6745 35.224C97.3851 35.1587 97.1098 35.126 96.8485 35.126C96.2511 35.126 95.7471 35.2567 95.3365 35.518C94.9351 35.77 94.6271 36.134 94.4125 36.61C94.2071 37.086 94.1045 37.6553 94.1045 38.318C94.1045 38.934 94.1931 39.48 94.3705 39.956C94.5571 40.4227 94.8418 40.7867 95.2245 41.048C95.6071 41.3093 96.0971 41.44 96.6945 41.44C97.0585 41.44 97.3991 41.4027 97.7165 41.328C98.0431 41.2533 98.3418 41.1553 98.6125 41.034V41.762C98.3698 41.8647 98.0898 41.9533 97.7725 42.028C97.4551 42.1027 97.0958 42.14 96.6945 42.14ZM103.185 34.412C103.829 34.412 104.361 34.5613 104.781 34.86C105.21 35.1493 105.532 35.5507 105.747 36.064C105.971 36.5773 106.083 37.17 106.083 37.842V38.374H100.763C100.763 39.3727 100.991 40.1333 101.449 40.656C101.915 41.1787 102.573 41.44 103.423 41.44C103.889 41.44 104.295 41.4027 104.641 41.328C104.986 41.2533 105.364 41.1227 105.775 40.936V41.664C105.401 41.832 105.033 41.9533 104.669 42.028C104.305 42.1027 103.88 42.14 103.395 42.14C102.657 42.14 102.027 41.986 101.505 41.678C100.991 41.37 100.599 40.9313 100.329 40.362C100.067 39.7833 99.9367 39.1113 99.9367 38.346C99.9367 37.5807 100.063 36.904 100.315 36.316C100.567 35.728 100.935 35.266 101.421 34.93C101.906 34.5847 102.494 34.412 103.185 34.412ZM103.185 35.084C102.494 35.084 101.939 35.3127 101.519 35.77C101.099 36.218 100.851 36.8667 100.777 37.716H105.257C105.257 37.1933 105.182 36.736 105.033 36.344C104.883 35.952 104.655 35.644 104.347 35.42C104.048 35.196 103.661 35.084 103.185 35.084ZM112.771 40.026C112.771 40.474 112.659 40.8567 112.435 41.174C112.211 41.4913 111.885 41.734 111.455 41.902C111.026 42.0607 110.503 42.14 109.887 42.14C109.374 42.14 108.917 42.0933 108.515 42C108.114 41.9067 107.773 41.7947 107.493 41.664V40.894C107.829 41.062 108.207 41.202 108.627 41.314C109.047 41.4167 109.472 41.468 109.901 41.468C110.648 41.468 111.185 41.3467 111.511 41.104C111.838 40.852 112.001 40.5113 112.001 40.082C112.001 39.802 111.922 39.5733 111.763 39.396C111.614 39.2093 111.385 39.046 111.077 38.906C110.779 38.7567 110.405 38.6073 109.957 38.458C109.5 38.2993 109.094 38.1407 108.739 37.982C108.385 37.814 108.109 37.604 107.913 37.352C107.717 37.1 107.619 36.7547 107.619 36.316C107.619 35.7187 107.862 35.252 108.347 34.916C108.833 34.58 109.481 34.412 110.293 34.412C110.741 34.412 111.157 34.454 111.539 34.538C111.931 34.622 112.286 34.734 112.603 34.874L112.323 35.532C112.137 35.448 111.927 35.3733 111.693 35.308C111.46 35.2333 111.222 35.1773 110.979 35.14C110.737 35.1027 110.494 35.084 110.251 35.084C109.663 35.084 109.206 35.1867 108.879 35.392C108.553 35.5973 108.389 35.896 108.389 36.288C108.389 36.5867 108.464 36.8247 108.613 37.002C108.772 37.17 109.001 37.3147 109.299 37.436C109.607 37.5573 109.976 37.6973 110.405 37.856C110.844 38.0053 111.241 38.164 111.595 38.332C111.959 38.5 112.244 38.7147 112.449 38.976C112.664 39.2373 112.771 39.5873 112.771 40.026Z"
              fill="#6B7280"/>
          </svg>
          <div class="flex-col justify-between text-gray-500 ">
            <ul>
              <div class="flex align-text-top">
                <fa-icon [icon]="faUsers" class="text-gray-500"></fa-icon>

                <li class="pb-4 ml-2.5 "><a routerLink="/allUsers" routerLinkActive=text-blue-600
                                            class="hover:text-blue-700 font-semibold">Пользователи</a></li>
              </div>
              <div class="flex">
                <fa-icon [icon]="faSignature" class="text-gray-500"></fa-icon>
                <li class="pb-4 ml-2.5"><a routerLink="/operations" routerLinkActive=text-blue-600
                                           class="hover:text-blue-700 font-semibold">Операции</a></li>
              </div>
              <div class="flex">
                <fa-icon [icon]="faPiggy" class="text-gray-500"></fa-icon>

                <li class="pb-4 ml-2.5"><a routerLink="/balances" routerLinkActive=text-blue-600
                                           class="hover:text-blue-700 font-semibold">Балансы</a></li>
              </div>
              <div *ngIf="!isLoggedIn()" class="flex">
                <fa-icon [icon]="faSignature" class="text-gray-500"></fa-icon>
                <li class="pb-4 ml-2.5"><a routerLink="/"
                                           class="hover:text-blue-700 font-semibold">Login</a> </li>
              </div>
            </ul>
            <div *ngIf="isLoggedIn()" class="flex fixed bottom-10">
              <svg width="13" height="15" viewBox="0 0 13 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M2.1875 6V4.6875C2.1875 2.52734 3.9375 0.75 6.125 0.75C8.28516 0.75 10.0625 2.52734 10.0625 4.6875V6H10.5C11.457 6 12.25 6.79297 12.25 7.75V13C12.25 13.9844 11.457 14.75 10.5 14.75H1.75C0.765625 14.75 0 13.9844 0 13V7.75C0 6.79297 0.765625 6 1.75 6H2.1875ZM3.9375 6H8.3125V4.6875C8.3125 3.48438 7.32812 2.5 6.125 2.5C4.89453 2.5 3.9375 3.48438 3.9375 4.6875V6Z"
                  fill="#403AFF"/>
              </svg>
                <button (click)="logout()"
                      class="pb-4 text-left text-blue-600 font-semibold ml-2.5">Выйти из системы
              </button>
            </div>
          </div>
        </nav>
      </div>
      <div class="flex-1 p-3">
        <router-outlet></router-outlet>
      </div>
    </div>
    <div *ngIf="isLoggedIn()" class="fixed bottom-0 left-0 w-full text-white px-4 text-black border-t-2 bg-white" >
      <p  class="align-middle pl-96 text-right text-black"><span class="p-4 ">Сегодня: <span
        class="font-bold">{{getDate()}}</span> </span> Текущий пользователь: <span
        class="font-bold"> {{getCurrentUsername()}}</span></p>
    </div>

  `,
  styleUrl: './app.component.css'
})
export class AppComponent {
  faUsers = faUsers;
  faSignature = faSignature;
  faPiggy = faPiggyBank;
  title = 'home';

  constructor(private authService: AuthService) {
  }

  isLoggedIn(): boolean {
    return this.authService.isAuthenticated();
  }

  logout(): void {
    this.authService.logout();
  }

  getCurrentUsername(): string {
    return this.authService.getCurrentUsername();
  }

  getDate(): string {
    const currentDate = new Date();
    const day = currentDate.getDate().toString().padStart(2, '0');
    const month = (currentDate.getMonth() + 1).toString().padStart(2, '0');
    const year = currentDate.getFullYear().toString();
    const formattedDate = `${day}.${month}.${year}`;
    return formattedDate;
  }

}
